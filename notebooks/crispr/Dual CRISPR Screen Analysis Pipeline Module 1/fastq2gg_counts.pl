#!/usr/bin/env perl

# this is run as follows: 
# perl fastq2gg_counts.pl CV4-Plasmid_S1_L001_R1_001.fastq CV4-Plasmid_S1_L001_R2_001.fastq CV4-Plasmid_counts.txt

open R1, $ARGV[0];
open R2, $ARGV[1];
my $outputfile = $ARGV[2];

$nm1 = 1;
$nm2 = 1;

%probes = (
"GAAGGAATCATCGAGGCATG" => "ABL1_chr9_133589790",
"TGTCCCCCAACTACGACAAG" => "ABL1_chr9_133738283",
"CCTCGTACACCTCCCCGTAC" => "ABL1_chr9_133738356",
"AGGCATGTAGTAGTCAAACT" => "ADA_chr20_43257696",
"AGCCCCTCTGCTGTGTTAGC" => "ADA_chr20_43257769",
"CGGGGCGCACGAGGGCACCA" => "ADA_chr20_43280245",
"TGTGCCGCAAAAGGTCTTCA" => "AKT1_chr14_105239609",
"GCCCGTCCTTGTCCAGCATG" => "AKT1_chr14_105239686",
"CTCGGGCACCATGAGCGACG" => "AKT1_chr14_105258968",
"TCACATGGAGAGCTCTTGAT" => "ALK_chr2_29541171",
"GATCAAGAGCTCTCCATGTG" => "ALK_chr2_29541172",
"AACGGCCTCCTCCGGCGGGA" => "ALK_chr2_30143522",
"GCCCCCTATGTACGCCTCCC" => "APC_chr5_112043408",
"GAAGTACTTAAACAACTACA" => "APC_chr5_112102023",
"AAAATGTCCCTCCGTTCTTA" => "APC_chr5_112102933",
"GGACGAGACAGCGGGGATCA" => "ARID1A_chr1_27022876",
"ATGGTCATCGGGTACCGCTG" => "ARID1A_chr1_27056286",
"GCGGTACCCGATGACCATGC" => "ARID1A_chr1_27056288",
"AAAATAATGGCAAACTCGAC" => "ARID2_chr12_46123614",
"TACCCGACACACTGTGTTGC" => "ARID2_chr12_46205318",
"TGGCCCTGCACTTGTACAGC" => "ARID2_chr12_46254608",
"ATCATTAAGTACTAGACTCA" => "ATM_chr11_108098350",
"CTCTATCATGTTCTAGTTGA" => "ATM_chr11_108098390",
"TGATAGAGCTACAGAACGAA" => "ATM_chr11_108098402",
"ATCAAACAGAGGCCGCATGC" => "BCL2_chr18_60795945",
"AACTGTACGGCCCCAGCATG" => "BCL2_chr18_60795960",
"ATGGCGCACGCTGGGAGAAC" => "BCL2_chr18_60985877",
"TGATACCATAGGTACCTGCA" => "BRAF_chr7_140508787",
"GTTGCTCCGTGCCACATCTG" => "BRAF_chr7_140534469",
"CATCTTATAACCGAGAGCCG" => "BRAF_chr7_140624501",
"TGAACCCGAAAATCCTTCCT" => "BRCA1_chr17_41256141",
"AAACTTACTTGCAAAATATG" => "BRCA1_chr17_41267735",
"TCTTGTGCTGACTTACCAGA" => "BRCA1_chr17_41276018",
"TCGTAGGTAAAAATGCCTAT" => "BRCA2_chr13_32890586",
"CTGTCTACCTGACCAATCGA" => "BRCA2_chr13_32912006",
"ATGTAGCACGCATTCACATA" => "BRCA2_chr13_32914228",
"ACAGGAGGAGGATTCGGCTG" => "BRD4_chr19_15376361",
"GTCGATGCTTGAGTTGTGTT" => "BRD4_chr19_15376403",
"ACTAGCATGTCTGCGGAGAG" => "BRD4_chr19_15383894",
"TAACTCACCTGGAAGGGATA" => "BTK_chrX_100626613",
"GATCACTTGTGTTGAAACAG" => "BTK_chrX_100629565",
"GTTCCAGTTCATCTATCACA" => "BTK_chrX_100645534",
"CCTGCTGAGCACGTGGAGTT" => "CASP8_chr2_202123033",
"GCTCTTCCGAATTAATAGAC" => "CASP8_chr2_202131404",
"TGATCGACCCTCCGCCAGAA" => "CASP8_chr2_202134297",
"TCGGCGTCCCCGGCCAGCCA" => "CDH1_chr16_68771300",
"CGCCGAGAGCTACACGTTCA" => "CDH1_chr16_68772250",
"CACCGTGAACGTGTAGCTCT" => "CDH1_chr16_68772255",
"AAACTCTGAAGCCGACCAGT" => "CDK4_chr12_58143253",
"CCACGGGTGTAAGTGCCATC" => "CDK4_chr12_58144705",
"GGTCTCCCTTGATCTGAGAA" => "CDK4_chr12_58145497",
"GCCGCCCAGCCAGAACACCT" => "CDK6_chr7_92244474",
"AGTTCAGATGTTGATCAACT" => "CDK6_chr7_92252365",
"GCGTCCAGGCGGCATGGAGA" => "CDK6_chr7_92462628",
"CGGCGCGTTGGAGGCGGCCA" => "CDK9_chr9_130548409",
"GCACCGCAAGACCGGCCAGA" => "CDK9_chr9_130548998",
"ACTACCCTTGCAGCGGTTAT" => "CDK9_chr9_130550235",
"TCAAACGTGCGAGTGTCTAA" => "CDKN1B_chr12_12870777",
"AAGAGGCGAGCCAGCGCAAG" => "CDKN1B_chr12_12870931",
"ATTGCTCCGCTAACCCCGTC" => "CDKN1B_chr12_12871196",
"TTGTAGAAGCAGGCATGCGT" => "CDKN2A_chr9_21968726",
"GACCCGTGCACGACGCTGCC" => "CDKN2A_chr9_21971100",
"CCCTGGAGGCGGCGAGAACA" => "CDKN2A_chr9_21994327",
"CATGACTCCACCGAGCACCT" => "CHEK1_chr11_125496644",
"CTGGGACTTGGTGCAAACCC" => "CHEK1_chr11_125496687",
"AATCTCTGAGCATCTGGTTC" => "CHEK1_chr11_125499147",
"TGAATCCACAGCTCTACCCC" => "CHEK2_chr22_29085137",
"AAGAAGCCTTAAGACACCCG" => "CHEK2_chr22_29090029",
"GGTCGTGATGTCTCGGGAGT" => "CHEK2_chr22_29130694",
"CACATTACCTTCTACTGAAG" => "DHFR_chr5_79949819",
"CAGATACCTGAGCGGTGGCC" => "DHFR_chr5_79950216",
"AGATACCTGAGCGGTGGCCA" => "DHFR_chr5_79950217",
"GGAGCAGCGATGCGACCCTC" => "EGFR_chr7_55086962",
"TGAGCTTGTTACTCGTGCCT" => "EGFR_chr7_55209986",
"GAGTAACAAGCTCACGCAGT" => "EGFR_chr7_55209992",
"GATTCCAGAAGATATGCCCC" => "ERBB2_chr17_37855800",
"CTGCCCCCTGCACAACCAAG" => "ERBB2_chr17_37868221",
"TGAGTGGGTACCTCGGGCAC" => "ERBB2_chr17_37868292",
"CATCAATCACACGTACCACC" => "FGFR2_chr10_123298118",
"TTCAGGTACGAAACCAGCAC" => "FGFR2_chr10_123298215",
"GGGGATTGGTACCGTAACCA" => "FGFR2_chr10_123353328",
"AGGCAGGGGCGCCCATGGCG" => "FGFR3_chr4_1795655",
"GACGCGCTGCTCCGTCCCCA" => "FGFR3_chr4_1795735",
"GGGGACGGAGCAGCGCGTCG" => "FGFR3_chr4_1795736",
"AGTGTACGAAGCTGCCGCTG" => "FLT3_chr13_28636131",
"AACGCACACCCGAGGTCTTC" => "FLT3_chr13_28636172",
"GGCATGGCCTCCGGAGCCCG" => "FLT3_chr13_28674643",
"AGCTGCGGACCGAGGCGAGA" => "FNTA_chr8_42911471",
"GATCCGGTGCCGCAGAATGA" => "FNTA_chr8_42914260",
"AGCCCAAAAACTATCAAGTT" => "FNTA_chr8_42924781",
"CGAGGCCATGGAGGTGACGG" => "GATA3_chr10_8097612",
"GTACTGCGCCGCGTCCATGT" => "GATA3_chr10_8097722",
"AACCACGTCCCGCCCTACTA" => "GATA3_chr10_8097790",
"GACGGTGAGCACCGTCCTCG" => "HDAC1_chr1_32757816",
"GCACCATGCAAAGAAGTCCG" => "HDAC1_chr1_32792601",
"TTACGTCAATGATATCGTCT" => "HDAC1_chr1_32792637",
"CCAGAACACTCCAGAATATA" => "HDAC2_chr6_114266539",
"TCCAACATCGAGCAACATTA" => "HDAC2_chr6_114267214",
"GAGCCCATGGCGTACAGTCA" => "HDAC2_chr6_114292056",
"GGTTGAGGTCATAGTTGAGG" => "HDAC6_chrX_48661089",
"TCCCTTGCAGTCCCACGATT" => "HDAC6_chrX_48661385",
"CCAGTGCTACAGTCTCGCAC" => "HDAC6_chrX_48674389",
"TTCTCTTGCAGGTGAACCTA" => "HSP90AA1_chr14_102551760",
"ACGATGATGAGCAGTACGCT" => "HSP90AA1_chr14_102552141",
"GGGCATCCGCGCTCCCCGTA" => "HSP90AA1_chr14_102605736",
"CGAGGTCGGGGACCCTCCTC" => "IGF1R_chr15_99192824",
"TGCCGCCACTACTACTATGC" => "IGF1R_chr15_99434664",
"CCACGACGGCGAGTGCATGC" => "IGF1R_chr15_99434807",
"TTCTGAAAAAGACTCTGCAT" => "JAK2_chr9_5021970",
"ACCTGTGACTCATGAAACAC" => "JAK2_chr9_5050721",
"TTACCTGATAGAGTTATAGA" => "JAK2_chr9_5050816",
"GAATACACTCTGCAGAGCTT" => "KDM5C_chrX_53241021",
"AGCTCTGCAGAGTGTATTCC" => "KDM5C_chrX_53241022",
"CCCAGACCTCGGGCCCACCA" => "KDM5C_chrX_53254068",
"CTCATCACCGAAAGCGGCGG" => "KDM6A_chrX_44732838",
"TTGGATAATCTTCCAATAAG" => "KDM6A_chrX_44820615",
"TTATTGGAAGATTATCCAAA" => "KDM6A_chrX_44820616",
"CTCATCGCGGTAGCTGCGAT" => "KIT_chr4_55524164",
"ACCGCGATGAGAGGCGCTCG" => "KIT_chr4_55524176",
"CTGTCTGGACGCGAAGCAGT" => "KIT_chr4_55524229",
"CCGACCATGCAGCACACCAA" => "KMT2D_chr12_49448161",
"CTCACCATTGGTGTGCTGCA" => "KMT2D_chr12_49448168",
"CTCCCGCTGCCCGTGTAGAC" => "KMT2D_chr12_49448468",
"CTGCAGAGCCGTCGGGGGCC" => "MAP2K1_chr15_66679721",
"CCCGACGGCTCTGCAGTTAA" => "MAP2K1_chr15_66679728",
"CCATACTTACTCCGCAGAGC" => "MAP2K1_chr15_66679756",
"ATGTAGCCCGCGAGAGAAAA" => "MAP3K1_chr5_56111382",
"CAAGATGGATGATCGTCCAG" => "MAP3K1_chr5_56152466",
"TCCCTGATCATTCGTTCCTC" => "MAP3K1_chr5_56152485",
"AGATAAACCTCTCATAATGA" => "MET_chr7_116339123",
"GCCAGATTCTGCCGAACCAA" => "MET_chr7_116340188",
"CACATGGCAGATCGATCCAT" => "MET_chr7_116340207",
"TGGCGCCAAAATGTCGTTCG" => "MLH1_chr3_37035029",
"TGATCCCGGTGCCATTGTCT" => "MLH1_chr3_37038179",
"TAATAGTAACATGAGCCACA" => "MLH1_chr3_37045912",
"CGACATACCGACAGCCGGCA" => "MSH6_chr2_48010356",
"TTACCCCTGGTGGCCTTGTC" => "MSH6_chr2_48018111",
"GGAACATTCATCCGCGAGAA" => "MSH6_chr2_48018154",
"GCTGGGTGCTGACCGCAATG" => "MTOR_chr1_11317010",
"GAGGAGGTTCCGAAGATAGT" => "MTOR_chr1_11317149",
"GAACCTCAGGGCAAGATGCT" => "MTOR_chr1_11319459",
"CATGTCCTCCCCGCGGCCGG" => "NF1_chr17_29422308",
"GTTGTGCTCAGTACTGACTT" => "NF1_chr17_29483038",
"AGTCAGTACTGAGCACAACA" => "NF1_chr17_29483039",
"ACGGAGGCTAAGCGTCGCAA" => "NonTargetingControlGuideForHuman0001",
"CGCTTCCGCGGCCCGTTCAA" => "NonTargetingControlGuideForHuman0002",
"TACTAACGCCGCTCCTACAG" => "NonTargetingControlGuideForHuman0006",
"GGGCCCGCATAGGATATCGC" => "NonTargetingControlGuideForHuman0008",
"TAGACAACCGCGGAGAATGC" => "NonTargetingControlGuideForHuman0009",
"CGCGACGACTCAACCTAGTC" => "NonTargetingControlGuideForHuman0028",
"GGTCACCGATCGAGAGCTAG" => "NonTargetingControlGuideForHuman0029",
"AAACGGTACGACAGCGTGTG" => "NonTargetingControlGuideForHuman0039",
"ACATAGTCGACGGCTCGATT" => "NonTargetingControlGuideForHuman0040",
"GATGGCGCTTCAGTCGTCGG" => "NonTargetingControlGuideForHuman0041",
"CGCAAGGTGTCGGTAACCCT" => "NonTargetingControlGuideForHuman0068",
"CTTCGACGCCATCGTGCTCA" => "NonTargetingControlGuideForHuman0069",
"GTCGTCCGGGATTACAAAAT" => "NonTargetingControlGuideForHuman0072",
"TATCGCTTCCGATTAGTCCG" => "NonTargetingControlGuideForHuman0074",
"TAAGATCCGCGGGTGGCAAC" => "NonTargetingControlGuideForHuman0076",
"GTAGACGTCGTGAGCTTCAC" => "NonTargetingControlGuideForHuman0077",
"AGCGCAGATAGCGCGTATCA" => "NonTargetingControlGuideForHuman0079",
"ACGTCCATACTGTCGGCTAC" => "NonTargetingControlGuideForHuman0082",
"TGGTTCCGTAGGTCGGTATA" => "NonTargetingControlGuideForHuman0084",
"TGCGGCGTAATGCTTGAAAG" => "NonTargetingControlGuideForHuman0093",
"CGAACTTAATCCCGTGGCAA" => "NonTargetingControlGuideForHuman0094",
"GCCGTGTTGCTGGATACGCC" => "NonTargetingControlGuideForHuman0095",
"GTACGGGGCGATCATCCACA" => "NonTargetingControlGuideForHuman0098",
"TTCACCGTCCACGTGCGCAT" => "NonTargetingControlGuideForHuman0152",
"GGGTGCCCACTAATAGCCGC" => "NonTargetingControlGuideForHuman0157",
"GGATTGAATGGCTAACGCGG" => "NonTargetingControlGuideForHuman0159",
"GCGGCGTCATCCACGCGTGC" => "NonTargetingControlGuideForHuman0178",
"GGGTATAGACGCGATCCTCA" => "NonTargetingControlGuideForHuman0179",
"CGACAACGTGCAGGTGTATC" => "NonTargetingControlGuideForHuman0244",
"TCTCGTAGCCTAATGCGCCA" => "NonTargetingControlGuideForHuman0246",
"CGTGCGGTAAATACGAAATA" => "NonTargetingControlGuideForHuman0264",
"GGCGATTCGGGTGGAGGTCG" => "NonTargetingControlGuideForHuman0273",
"AGTTGAATGGACCTCGACTA" => "NonTargetingControlGuideForHuman0274",
"TTCCACGGTAAAATCGGTCA" => "NonTargetingControlGuideForHuman0276",
"ACGGAAAGACCTCGCTATTC" => "NonTargetingControlGuideForHuman0284",
"CCATCACCGATCGTGAGCCT" => "NonTargetingControlGuideForHuman0316",
"GGCACTCCGAAAGACCTTAT" => "NonTargetingControlGuideForHuman0322",
"CCCAGGTGTATAATGAAACG" => "NonTargetingControlGuideForHuman0323",
"GCCATTCTAGTCCCGGCATA" => "NonTargetingControlGuideForHuman0352",
"GAGTGATGCTTAGACTCCGT" => "NonTargetingControlGuideForHuman0362",
"GCACGCTGTACAGACGACAA" => "NonTargetingControlGuideForHuman0412",
"CTGCGTGTCTTGCTCGCATG" => "NonTargetingControlGuideForHuman0433",
"CCTAGTTCATAAGCTACGCC" => "NonTargetingControlGuideForHuman0434",
"TGCCGCTATACTAAAACCTT" => "NonTargetingControlGuideForHuman0485",
"CCCCTATGCAGACTACAATT" => "NonTargetingControlGuideForHuman0515",
"TAGATTGGCCCCACAAAGCG" => "NonTargetingControlGuideForHuman0586",
"ACTATCATGGCACCCAATTG" => "NonTargetingControlGuideForHuman0654",
"ATTGACCGCTGGTACCATCC" => "PARP1_chr1_226578249",
"GGTGCGCCTGTCCAAGAAGA" => "PARP1_chr1_226578301",
"CGAGTCGAGTACGCCAAGAG" => "PARP1_chr1_226595581",
"ATAAAGCCGCTTGCAAACTC" => "PBRM1_chr3_52696257",
"CAATGCAAAGTCCTATTATA" => "PBRM1_chr3_52702516",
"TAGAAGAAGTTGGATTCCAT" => "PBRM1_chr3_52713723",
"AGCTATGGGGACTTCCCATC" => "PDGFRA_chr4_55124932",
"GTCTTAGGCTGTCTTCTCAC" => "PDGFRA_chr4_55124963",
"TCGGGATCAGTTGTGCGACA" => "PDGFRA_chr4_55129914",
"ATGCCTCCACGACCATCATC" => "PIK3CA_chr3_178916614",
"TGTTATAGGGCAAATAATAG" => "PIK3CA_chr3_178919070",
"GCTTCAGCAATTACTTGTTC" => "PIK3CA_chr3_178919167",
"AATCATACAGCGCTCTGTAC" => "PIK3R1_chr5_67522521",
"CTAGCATACCTCATCAGTAT" => "PIK3R1_chr5_67576410",
"AGCGTAAGCCAATACTGATG" => "PIK3R1_chr5_67576421",
"GAAACAGCTGTCTCCGTAAA" => "PRKDC_chr8_48686398",
"GGTCTGTTGCCTGGTCCATC" => "PRKDC_chr8_48686781",
"GGGAGCGGGACTCGGCGGCA" => "PRKDC_chr8_48872683",
"TTATCCAAACATTATTGCTA" => "PTEN_chr10_89653786",
"ACAGATTGTATATCTTGTAA" => "PTEN_chr10_89685297",
"TGGGAATAGTTACTCCCTGG" => "PTEN_chr10_89711868",
"GCCCAAAACCCCCCGAAAAA" => "RB1_chr13_48878054",
"TTCAGGGGAAGTATTACAAA" => "RB1_chr13_48934148",
"TGTTCGAGGTGAACCATTAA" => "RB1_chr13_48936969",
"GTGCATTCCTCCTCTCGCTG" => "ROR1_chr1_64240072",
"ATGCACCGGCCGCGCCGCCG" => "ROR1_chr1_64240089",
"GCGCTGCTGCTGGCCGCACG" => "ROR1_chr1_64240143",
"CCGGGCCCATGAGGCGACGA" => "RPS6KB1_chr17_57970538",
"GGGTCAGTTAAATGAAAGCA" => "RPS6KB1_chr17_57987922",
"CATATGGTCCAACTCCCCCA" => "RPS6KB1_chr17_57987949",
"AGGGGCAAGGCGCAGCCAAT" => "RRM2_chr2_10262728",
"TGTCCCGCTCGCGCCCATCA" => "RRM2_chr2_10262940",
"CAGCTGCTGCGGGTCCGTGA" => "RRM2_chr2_10262957",
"CACTTCGACCGACAAACCTG" => "RUNX1_chr21_36252860",
"TACCGCAGCCATGAAGAACC" => "RUNX1_chr21_36252902",
"ATGAAGCACTGTGGGTACGA" => "RUNX1_chr21_36421144",
"GACTATCAGTTCCAGAGATA" => "SETD2_chr3_47142951",
"AACGTTAACTCTGAGCCTGA" => "SETD2_chr3_47142972",
"TCATCGGGAGCGGCTGGAGA" => "SETD2_chr3_47205411",
"ACTATGCACAATGCTCAGAC" => "SMAD4_chr18_48573460",
"GGATTAACACTGCAGAGTAA" => "SMAD4_chr18_48575673",
"AATGCAAGCTCATTGTGAAC" => "SMAD4_chr18_48586241",
"TCTGGAGTGGACATCTTCAC" => "SMARCA4_chr19_11094819",
"CTGGCCGAGGAGTTCCGCCC" => "SMARCA4_chr19_11094851",
"TTGTCCTGAGGGTACCCTCC" => "SMARCA4_chr19_11095011",
"ATCATTGCGGCGGCAGAGGC" => "SMARCB1_chr22_24129339",
"AACTACCTCCGTATGTTCCG" => "SMARCB1_chr22_24133949",
"CTAGTCGCCTCCAGAGTGAG" => "SMARCB1_chr22_24133993",
"TGAGTTGGCGGGGTTGGCCA" => "SMO_chr7_128828974",
"AGTGCGAAGTGCCCTTGGTT" => "SMO_chr7_128845081",
"CACGTCCTCGTACCAGCTCT" => "SMO_chr7_128845117",
"TAGCAACAAGAGCAAGCCCA" => "SRC_chr20_36012562",
"CTCACGTGTTGTTGACAATC" => "SRC_chr20_36014563",
"TAACCGCTCTGACTCCCGTC" => "SRC_chr20_36022600",
"TCCCTCCGGGCCGACATGAG" => "TOP1_chr20_39657693",
"AACACAAAGATCGAGAACAC" => "TOP1_chr20_39690055",
"AAAAGTCCAAGCATAGCAAC" => "TOP1_chr20_39690109",
"CCGGTTCATGCCGCCCATGC" => "TP53_chr17_7577537",
"GAGCGCTGCTCAGATAGCGA" => "TP53_chr17_7578373",
"TCGACGCTAGGATCTGACTG" => "TP53_chr17_7579881",
"ACCTTCGAGGGTCCAGTTCA" => "TSC1_chr9_135796748",
"GGAGCATGTGCGAATTCATC" => "TSC1_chr9_135796796",
"AGCGCCTTCGAGCGAGAGAA" => "TSC1_chr9_135804256",
"CGCCCGCCGCGCCATGCCTG" => "TYMS_chr18_657730",
"TGACAACCAAACGTGTGTTC" => "TYMS_chr18_659656",
"ACCCTTCCAGAACACACGTT" => "TYMS_chr18_659665",
"TCAGCGCGACTGGTCAGCTG" => "VEGFA_chr6_43738425",
"GTGGTCCCAGGCTGCACCCA" => "VEGFA_chr6_43742077",
"GGAGGGCAGAATCATCACGA" => "VEGFA_chr6_43742108",
"GGATCGCGGAGGGAATGCCC" => "VHL_chr3_10183518",
"CGCGCGTCGTGCTGCCCGTA" => "VHL_chr3_10183773",
"GCCGTCGAAGTTGAGCCATA" => "VHL_chr3_10183791",
"TCATCGCGGCCCTGGGGACG" => "WEE1_chr11_9595462",
"GAAGATCAGCTTCTGCCGCA" => "WEE1_chr11_9595542",
"CGGCGACTTGACCGGCGACG" => "WEE1_chr11_9595845",
);


if (!open(IN, "CV4_2spacers.txt")) {
        print  ("ERROR: Could not open file CV4_2spacers.txt\n");
        die;
}

if (!open(OUT, ">$outputfile")) {
        print  ("ERROR: Could not open $outputfile\n");
        die;
}

$line = <IN>;
while($line=<IN>){
        chomp $line;
        ($loc, $A, $B) = (split /\t/, $line)[1,3,7];
        if (substr($A, 0, 4) eq "NonT") {$A = "0"};
        if (substr($B, 0, 4) eq "NonT") {$B = "0"};
        $hash{$loc} = 0;  
        $more{$loc} = "$A\t$B"; 
}

while ($line1 = <R1>) {
   $Line1 = <R2>;

   $seqA = <R1>;
   $seqB = <R2>;
        $line3 = <R1>;
        $Line3 = <R2>;

        $line4 = <R1>;
        $Line4 = <R2>;
   chomp $seqA;
   $IDA = substr($seqA, 30, 20); #relevant piece of read 1
#  now find what the true bar code should have been if imperfect match
   $score = 0;
   $trueIDA = "";
   foreach $key (keys(%probes)) {
      my $count = ($IDA^$key)  =~ tr/\0//;
      if ($count > $score) {
         $score = $count;
         $trueIDA = $key
      }
   }
   if ($score >= 20-$nm1) {#accept $true_plateID as the true plate ID
      $gA = $trueIDA;

      chomp $seqB;
      (my $revB = reverse $seqB) =~ tr/ACGTacgt/TGCAtgca/;
      $IDB = substr($revB, 22, 20); #relevant piece of read 2
#  now find what the true bar code should have been if imperfect match
      $score = 0;
      $trueIDB = "";
      foreach $key (keys(%probes)) {
         my $count = ($IDB^$key)  =~ tr/\0//;
         if ($count > $score) {
            $score = $count;
            $trueIDB = $key
         }
      }
      if ($score >= 20-$nm2) {#accept $true_plateID as the true plate ID
         $gB = $trueIDB;
         $gg = "$probes{$gA}__$probes{$gB}";
         if (exists($hash{$gg})) { $hash{$gg}++ };
#        print "$probes{$gA}__$probes{$gB}\n"};
      }


   }


}

$sample = substr($ARGV[0], 0, index($ARGV[0], "_R1"));
print OUT "ID\tgeneA\tgeneB\t$sample\n";
foreach $key (sort (keys(%hash))) {
   print OUT "$key\t$more{$key}\t$hash{$key}\n";
}

close R1;
close R2;
close IN;
close OUT;
